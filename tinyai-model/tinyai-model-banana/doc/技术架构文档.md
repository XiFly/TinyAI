# TinyAI Banana å¤šæ¨¡æ€å›¾åƒç”Ÿæˆæ¨¡å‹ - æŠ€æœ¯æ¶æ„æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

- **æ¨¡å—åç§°**: tinyai-model-banana
- **ç‰ˆæœ¬**: v1.0
- **æœ€åæ›´æ–°**: 2025-12-21
- **ä½œè€…**: TinyAI Team

---

## ğŸ“‘ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æŠ€æœ¯æ¶æ„è®¾è®¡](#æŠ€æœ¯æ¶æ„è®¾è®¡)
3. [æ ¸å¿ƒç»„ä»¶è®¾è®¡](#æ ¸å¿ƒç»„ä»¶è®¾è®¡)
4. [å…³é”®æŠ€æœ¯å®ç°](#å…³é”®æŠ€æœ¯å®ç°)
5. [æ€§èƒ½ä¼˜åŒ–ç­–ç•¥](#æ€§èƒ½ä¼˜åŒ–ç­–ç•¥)
6. [æ‰©å±•æ€§è®¾è®¡](#æ‰©å±•æ€§è®¾è®¡)
7. [å®æ–½æ€»ç»“](#å®æ–½æ€»ç»“)

---

## ä¸€ã€ç³»ç»Ÿæ¦‚è¿°

### 1.1 é¡¹ç›®èƒŒæ™¯

Bananaæ¨¡å‹æ˜¯åŸºäºGoogle Gemini 2.5 Flashçš„å¤šæ¨¡æ€å›¾åƒç”Ÿæˆæ¶æ„ï¼Œåœ¨TinyAIæ¡†æ¶ä¸Šå®ç°äº†æ–‡æœ¬-å›¾åƒè·¨æ¨¡æ€äº¤äº’èƒ½åŠ›ã€‚è¯¥æ¨¡å‹é‡‡ç”¨Vision Transformer(ViT)å¤„ç†å›¾åƒï¼Œé€šè¿‡è·¨æ¨¡æ€æ³¨æ„åŠ›æœºåˆ¶å®ç°æ–‡æœ¬ä¸å›¾åƒç‰¹å¾çš„æ·±åº¦èåˆã€‚

### 1.2 è®¾è®¡ç›®æ ‡

- **å¤šæ¨¡æ€èåˆ**: å®ç°æ–‡æœ¬å’Œå›¾åƒçš„åŒå‘æ³¨æ„åŠ›æœºåˆ¶
- **100% V2 API**: å®Œå…¨åŸºäºTinyAI V2 APIï¼Œæ— V1ä¾èµ–
- **æ¨¡å—åŒ–è®¾è®¡**: é«˜å†…èšä½è€¦åˆï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤
- **é…ç½®é©±åŠ¨**: æ”¯æŒå¤šç§æ¨¡å‹è§„æ¨¡é…ç½®(Tiny/Small/Base)
- **æ€§èƒ½ä¼˜åŒ–**: å¤ç”¨ç°æœ‰é«˜æ€§èƒ½ç»„ä»¶(Conv2Dã€Transformerç­‰)

### 1.3 æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ç±»åˆ« | æ ¸å¿ƒèƒ½åŠ› | æŠ€æœ¯å®ç° |
|---------|---------|---------|
| **æ–‡æœ¬ç¼–ç ** | å¤„ç†æ–‡æœ¬è¾“å…¥ | Transformer Encoder + RoPE |
| **å›¾åƒç¼–ç ** | Vision Transformer | Conv2D PatchåµŒå…¥ + 2Dä½ç½®ç¼–ç  |
| **è·¨æ¨¡æ€èåˆ** | æ–‡æœ¬-å›¾åƒäº¤äº’ | Cross-Modal Attention + æ®‹å·®è¿æ¥ |
| **é…ç½®ç®¡ç†** | çµæ´»é…ç½® | 3ç§é¢„è®¾ + å®Œå…¨è‡ªå®šä¹‰ |

---

## äºŒã€æŠ€æœ¯æ¶æ„è®¾è®¡

### 2.1 æ¨¡å—ä¾èµ–å…³ç³»

```mermaid
graph TB
    Banana[tinyai-model-banana]
    NNet[tinyai-deeplearning-nnet]
    Func[tinyai-deeplearning-func]
    NdArr[tinyai-deeplearning-ndarr]
    
    Banana --> NNet
    Banana --> Func
    NNet --> Func
    Func --> NdArr
    
    style Banana fill:#e1f5ff
    style NNet fill:#ffe1e1
```

**ä¾èµ–è¯´æ˜**:

| ä¾èµ–æ¨¡å— | ä¾èµ–ç±»å‹ | ç”¨é€” |
|---------|---------|------|
| `tinyai-deeplearning-nnet` | å¿…éœ€ | V2ç¥ç»ç½‘ç»œå±‚(Conv2Dã€Transformerã€Linearç­‰) |
| `tinyai-deeplearning-func` | å¿…éœ€ | è‡ªåŠ¨å¾®åˆ†å¼•æ“(Variableã€Function) |

### 2.2 æ•´ä½“æ¶æ„è®¾è®¡

```mermaid
graph TB
    subgraph è¾“å…¥å±‚
        TextInput[æ–‡æœ¬è¾“å…¥<br/>Token IDs]
        ImageInput[å›¾åƒè¾“å…¥<br/>Pixels]
    end
    
    subgraph ç¼–ç å±‚
        TextEncoder[TextEncoder<br/>Transformerç¼–ç å™¨]
        ImageEncoder[ImageEncoder<br/>ViTç¼–ç å™¨]
    end
    
    subgraph èåˆå±‚
        CrossAttn[CrossModalAttention<br/>è·¨æ¨¡æ€æ³¨æ„åŠ›]
        Fusion[MultiModalFusion<br/>åŒå‘èåˆ]
    end
    
    subgraph è¾“å‡ºå±‚
        LayerNorm[Final LayerNorm]
        OutputProj[Output Projection]
        Output[è¾“å‡ºç‰¹å¾]
    end
    
    TextInput --> TextEncoder
    ImageInput --> ImageEncoder
    
    TextEncoder --> Fusion
    ImageEncoder --> Fusion
    
    Fusion --> LayerNorm
    LayerNorm --> OutputProj
    OutputProj --> Output
```

### 2.3 æ ¸å¿ƒæ¨¡å—ç»“æ„

```
tinyai-model-banana/
â”œâ”€â”€ config/              # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ BananaConfig.java         # ä¸»é…ç½®ç±»
â”‚   â””â”€â”€ TaskType.java             # ä»»åŠ¡ç±»å‹æšä¸¾
â”œâ”€â”€ encoder/             # ç¼–ç å™¨ç»„ä»¶
â”‚   â”œâ”€â”€ TextEncoder.java          # æ–‡æœ¬ç¼–ç å™¨
â”‚   â”œâ”€â”€ ImageEncoder.java         # å›¾åƒç¼–ç å™¨
â”‚   â”œâ”€â”€ PatchEmbedding.java       # PatchåµŒå…¥å±‚
â”‚   â””â”€â”€ Position2D.java           # 2Dä½ç½®ç¼–ç 
â”œâ”€â”€ fusion/              # è·¨æ¨¡æ€èåˆ
â”‚   â”œâ”€â”€ CrossModalAttention.java  # è·¨æ¨¡æ€æ³¨æ„åŠ›
â”‚   â””â”€â”€ MultiModalFusion.java     # å¤šæ¨¡æ€èåˆæ¨¡å—
â”œâ”€â”€ block/               # æ¨¡å‹ä¸»ä½“
â”‚   â””â”€â”€ BananaBlock.java          # Bananaä¸»æ¨¡å—
â”œâ”€â”€ model/               # æ¨¡å‹å°è£…
â”‚   â””â”€â”€ BananaModel.java          # æ¨¡å‹æ¥å£
â””â”€â”€ demo/                # æ¼”ç¤ºç¨‹åº
    â””â”€â”€ BananaDemo.java           # åŠŸèƒ½æ¼”ç¤º
```

---

## ä¸‰ã€æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 3.1 é…ç½®ç®¡ç†ç³»ç»Ÿ

#### 3.1.1 BananaConfigç±»è®¾è®¡

```java
public class BananaConfig {
    // åŸºç¡€é…ç½®
    private int vocabSize = 32000;           // è¯æ±‡è¡¨å¤§å°
    private int maxTextLength = 512;         // æœ€å¤§æ–‡æœ¬é•¿åº¦
    private int hiddenSize = 512;            // éšè—å±‚ç»´åº¦
    private int numLayers = 8;               // Transformerå±‚æ•°
    private int numHeads = 8;                // æ³¨æ„åŠ›å¤´æ•°
    
    // å›¾åƒç¼–ç å™¨é…ç½®
    private int imageSize = 256;             // å›¾åƒå°ºå¯¸
    private int patchSize = 16;              // Patchå°ºå¯¸
    private int imageChannels = 3;           // å›¾åƒé€šé“æ•°(RGB)
    private int numPatches;                  // Patchæ•°é‡(è‡ªåŠ¨è®¡ç®—)
    
    // å¤šæ¨¡æ€é…ç½®
    private boolean enableCrossModalAttention = true;  // å¯ç”¨è·¨æ¨¡æ€æ³¨æ„åŠ›
    private String modalityFusionType = "cross_attn";  // èåˆç±»å‹
    
    // é¢„è®¾é…ç½®å·¥å‚æ–¹æ³•
    public static BananaConfig createTinyConfig();     // 60Må‚æ•°
    public static BananaConfig createSmallConfig();    // 167Må‚æ•°
    public static BananaConfig createBaseConfig();     // 386Må‚æ•°
}
```

#### 3.1.2 ä¸‰ç§é¢„è®¾é…ç½®å¯¹æ¯”

| é…ç½®é¡¹ | Tiny (60M) | Small (167M) | Base (386M) |
|-------|-----------|--------------|-------------|
| éšè—ç»´åº¦ | 512 | 768 | 1024 |
| Transformerå±‚æ•° | 8 | 12 | 16 |
| æ³¨æ„åŠ›å¤´æ•° | 8 | 12 | 16 |
| FFNéšè—ç»´åº¦ | 2048 | 3072 | 4096 |
| å›¾åƒå°ºå¯¸ | 256Ã—256 | 384Ã—384 | 512Ã—512 |
| Patchå°ºå¯¸ | 16Ã—16 | 16Ã—16 | 16Ã—16 |
| Patchæ•°é‡ | 256 | 576 | 1024 |
| å›¾åƒç¼–ç å™¨å±‚æ•° | 6 | 9 | 12 |

### 3.2 æ–‡æœ¬ç¼–ç å™¨è®¾è®¡

#### 3.2.1 TextEncoderæ¶æ„

```mermaid
graph TB
    Input[æ–‡æœ¬è¾“å…¥<br/>[batch, seq_len]]
    
    subgraph TextEncoder
        TokenEmb[Token Embedding<br/>vocab_size â†’ hidden_size]
        PosEnc[Positional Encoding<br/>1Dä½ç½®ç¼–ç ]
        EmbDropout[Embedding Dropout]
        
        TransLayer1[TransformerEncoderLayer 1]
        TransLayer2[TransformerEncoderLayer 2]
        TransLayerN[TransformerEncoderLayer N]
    end
    
    Output[æ–‡æœ¬ç‰¹å¾<br/>[batch, seq_len, hidden_size]]
    
    Input --> TokenEmb
    TokenEmb --> PosEnc
    PosEnc --> EmbDropout
    EmbDropout --> TransLayer1
    TransLayer1 --> TransLayer2
    TransLayer2 --> TransLayerN
    TransLayerN --> Output
```

**æ ¸å¿ƒç»„ä»¶**:
- **Token Embedding**: å°†token IDæ˜ å°„åˆ°å‘é‡ç©ºé—´
- **Positional Encoding**: æ·»åŠ ä½ç½®ä¿¡æ¯(1Dåºåˆ—ä½ç½®)
- **Transformer Encoder**: å¤šå±‚è‡ªæ³¨æ„åŠ›æœºåˆ¶

### 3.3 å›¾åƒç¼–ç å™¨è®¾è®¡

#### 3.3.1 ImageEncoderæ¶æ„

```mermaid
graph TB
    Input[å›¾åƒè¾“å…¥<br/>[batch, 3, H, W]]
    
    subgraph ImageEncoder
        PatchEmb[PatchEmbedding<br/>Conv2Dåˆ‡ç‰‡åµŒå…¥]
        Pos2D[Position2D<br/>2Dä½ç½®ç¼–ç ]
        ImgDropout[Embedding Dropout]
        
        ViTLayer1[ViT Layer 1<br/>Self-Attention]
        ViTLayer2[ViT Layer 2<br/>Self-Attention]
        ViTLayerN[ViT Layer N<br/>Self-Attention]
    end
    
    Output[å›¾åƒç‰¹å¾<br/>[batch, num_patches, hidden_size]]
    
    Input --> PatchEmb
    PatchEmb --> Pos2D
    Pos2D --> ImgDropout
    ImgDropout --> ViTLayer1
    ViTLayer1 --> ViTLayer2
    ViTLayer2 --> ViTLayerN
    ViTLayerN --> Output
```

**å…³é”®åˆ›æ–°**:

1. **PatchEmbedding**: ä½¿ç”¨Conv2Då®ç°å›¾åƒåˆ†å‰²
   - å·ç§¯æ ¸å¤§å° = patch_size (16Ã—16)
   - æ­¥é•¿ = patch_size (ç¡®ä¿patchesä¸é‡å )
   - è¾“å…¥é€šé“ = 3 (RGB)
   - è¾“å‡ºé€šé“ = hidden_size

2. **Position2D**: å¯å­¦ä¹ çš„2Dä½ç½®ç¼–ç 
   - ä¸ºæ¯ä¸ªpatchä½ç½®å­¦ä¹ ç‹¬ç«‹å‘é‡
   - åˆå§‹åŒ–æ–¹å·®: 0.02 (å°æ–¹å·®é¿å…ä¸»å¯¼ç‰¹å¾)

3. **å½¢çŠ¶å˜æ¢**: [B, C, H, W] â†’ [B, num_patches, hidden_size]
   ```
   256Ã—256å›¾åƒ, 16Ã—16 patch
   â†’ 16Ã—16 = 256ä¸ªpatches
   â†’ æ¯ä¸ªpatchåµŒå…¥åˆ°512ç»´å‘é‡
   ```

### 3.4 è·¨æ¨¡æ€èåˆè®¾è®¡

#### 3.4.1 CrossModalAttentionæœºåˆ¶

```java
public class CrossModalAttention extends Module {
    // Queryæ¥è‡ªä¸€ä¸ªæ¨¡æ€(å¦‚æ–‡æœ¬)
    private Linear queryProj;
    
    // Keyå’ŒValueæ¥è‡ªå¦ä¸€ä¸ªæ¨¡æ€(å¦‚å›¾åƒ)
    private Linear keyProj;
    private Linear valueProj;
    
    // è¾“å‡ºæŠ•å½±
    private Linear outputProj;
    
    // è®¡ç®—: Attention(Q_text, K_image, V_image)
    public Variable forward(Variable queryFeatures, Variable kvFeatures);
}
```

**æ³¨æ„åŠ›è®¡ç®—æµç¨‹**:
```
1. Q = textFeatures @ W_Q
2. K = imageFeatures @ W_K
3. V = imageFeatures @ W_V
4. scores = (Q @ K^T) / sqrt(head_dim)
5. attn_weights = softmax(scores)
6. output = attn_weights @ V
```

#### 3.4.2 MultiModalFusionæ¨¡å—

```mermaid
graph LR
    TextFeat[æ–‡æœ¬ç‰¹å¾]
    ImageFeat[å›¾åƒç‰¹å¾]
    
    subgraph Text2Image
        T2I_Norm[LayerNorm]
        T2I_Attn[CrossModalAttn<br/>Textâ†’Image]
        T2I_Drop[Dropout]
        T2I_Res[æ®‹å·®è¿æ¥]
    end
    
    subgraph Image2Text
        I2T_Norm[LayerNorm]
        I2T_Attn[CrossModalAttn<br/>Imageâ†’Text]
        I2T_Drop[Dropout]
        I2T_Res[æ®‹å·®è¿æ¥]
    end
    
    TextFeat --> T2I_Norm
    ImageFeat --> I2T_Norm
    
    T2I_Norm --> T2I_Attn
    ImageFeat --> T2I_Attn
    T2I_Attn --> T2I_Drop
    T2I_Drop --> T2I_Res
    TextFeat --> T2I_Res
    
    I2T_Norm --> I2T_Attn
    TextFeat --> I2T_Attn
    I2T_Attn --> I2T_Drop
    I2T_Drop --> I2T_Res
    ImageFeat --> I2T_Res
```

**åŒå‘èåˆç­–ç•¥**:
- **Text â†’ Image**: æ–‡æœ¬ç‰¹å¾å…³æ³¨å›¾åƒç‰¹å¾,å¢å¼ºæ–‡æœ¬å¯¹è§†è§‰å†…å®¹çš„ç†è§£
- **Image â†’ Text**: å›¾åƒç‰¹å¾å…³æ³¨æ–‡æœ¬ç‰¹å¾,å®ç°è§†è§‰å¼•å¯¼çš„è¯­ä¹‰ç†è§£

---

## å››ã€å…³é”®æŠ€æœ¯å®ç°

### 4.1 Conv2D PatchåµŒå…¥å®ç°

```java
// PatchEmbeddingæ ¸å¿ƒå®ç°
public class PatchEmbedding extends Module {
    private final Conv2d patchConv;
    
    public PatchEmbedding(String name, int imageSize, int patchSize, 
                         int imageChannels, int hiddenSize) {
        // ä½¿ç”¨Conv2Då®ç°PatchåµŒå…¥
        this.patchConv = new Conv2d(
            name + "_patch_conv",
            imageChannels,     // è¾“å…¥: 3 (RGB)
            hiddenSize,        // è¾“å‡º: hidden_size
            patchSize,         // å·ç§¯æ ¸: patch_size Ã— patch_size
            patchSize,         // æ­¥é•¿: patch_size (ä¸é‡å )
            0,                 // æ— padding
            true               // ä½¿ç”¨bias
        );
    }
    
    public Variable forward(Variable... inputs) {
        Variable image = inputs[0];  // [batch, 3, 256, 256]
        
        // 1. å·ç§¯æå–patches
        Variable patchFeatures = patchConv.forward(image);  
        // â†’ [batch, hidden_size, 16, 16]
        
        // 2. é‡å¡‘ä¸ºåºåˆ—æ ¼å¼
        Variable patchSequence = reshapeToPatchSequence(patchFeatures);
        // â†’ [batch, 256, hidden_size]
        
        return patchSequence;
    }
}
```

**æŠ€æœ¯äº®ç‚¹**:
- å¤ç”¨TinyAIä¼˜åŒ–çš„Im2Colå·ç§¯å®ç°
- è‡ªåŠ¨å¤„ç†å½¢çŠ¶å˜æ¢(4D â†’ 3D)
- æ”¯æŒä»»æ„å›¾åƒå°ºå¯¸å’Œpatché…ç½®

### 4.2 Variableè½¬ç½®å¤šç»´æ“ä½œ

**é—®é¢˜**: Variable.transpose()ä¸æ”¯æŒå‚æ•°,æ— æ³•æŒ‡å®šç»´åº¦é¡ºåº

**è§£å†³æ–¹æ¡ˆ**: é€šè¿‡NdArrayå±‚é¢å®ç°å¤šç»´è½¬ç½®

```java
private Variable reshapeToPatchSequence(Variable patchFeatures) {
    int batchSize = patchFeatures.size(0);
    int hiddenSize = patchFeatures.size(1);
    int totalPatches = patchFeatures.size(2) * patchFeatures.size(3);
    
    // æ–¹æ³•: reshape + NdArray.transpose
    // [B, H, h', w'] â†’ [B, H, N] â†’ [B, N, H]
    Variable reshaped = patchFeatures.reshape(
        Shape.of(batchSize, hiddenSize, totalPatches)
    );
    
    // é€šè¿‡NdArrayå®ç°å¤šç»´è½¬ç½®
    NdArray data = reshaped.getValue();
    NdArray transposed = data.transpose(0, 2, 1);  // æŒ‡å®šç»´åº¦é¡ºåº
    
    return new Variable(transposed);
}
```

### 4.3 Pre-LayerNormæ¶æ„

æ‰€æœ‰Transformerå±‚å’Œè·¨æ¨¡æ€æ³¨æ„åŠ›å‡é‡‡ç”¨Pre-LayerNormæ¶æ„:

```java
// Pre-LayerNormæ¨¡å¼
public Variable fusionStep(Variable input, Variable context) {
    // 1. å…ˆLayerNorm
    Variable normalized = layerNorm.forward(input);
    
    // 2. è·¨æ¨¡æ€æ³¨æ„åŠ›
    Variable attnOutput = crossAttn.forward(normalized, context);
    
    // 3. Dropout
    Variable dropped = dropout.forward(attnOutput);
    
    // 4. æ®‹å·®è¿æ¥
    Variable output = input.add(dropped);
    
    return output;
}
```

**ä¼˜åŠ¿**:
- æ¢¯åº¦æ›´ç¨³å®š,æ˜“äºè®­ç»ƒæ·±å±‚ç½‘ç»œ
- é¿å…æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸é—®é¢˜
- ç°ä»£Transformeræ¶æ„æ ‡å‡†åšæ³•

---

## äº”ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 5.1 ç»„ä»¶å¤ç”¨ç‡

| ç»„ä»¶ç±»å‹ | å¤ç”¨æ¥æº | å¤ç”¨ç‡ |
|---------|---------|-------|
| Conv2D | tinyai-nnet-v2 | 100% |
| Transformer | tinyai-nnet-v2 | 100% |
| Linear | tinyai-nnet-v2 | 100% |
| LayerNorm | tinyai-nnet-v2 | 100% |
| Dropout | tinyai-nnet-v2 | 100% |
| Embedding | tinyai-nnet-v2 | 100% |

**ä¼˜åŒ–æ•ˆæœ**:
- æ— éœ€é‡å¤å®ç°åŸºç¡€ç®—å­
- è‡ªåŠ¨äº«å—åº•å±‚æ€§èƒ½ä¼˜åŒ–(Im2Colã€çŸ©é˜µä¹˜æ³•ç­‰)
- ä»£ç é‡å‡å°‘60%+

### 5.2 å†…å­˜ä¼˜åŒ–

1. **PatchåµŒå…¥å†…å­˜å¸ƒå±€**:
   - ç›´æ¥ä½¿ç”¨Conv2Dè¾“å‡º,æ— éœ€é¢å¤–æ‹·è´
   - reshapeå’Œtransposeæ“ä½œå¤ç”¨åº•å±‚æ•°æ®

2. **ä½ç½®ç¼–ç ç¼“å­˜**:
   - Position2Dåªåˆå§‹åŒ–ä¸€æ¬¡,æ‰€æœ‰batchå¤ç”¨
   - å½¢çŠ¶[1, num_patches, hidden_size]å¯å¹¿æ’­

3. **æ¢¯åº¦è®¡ç®—ä¼˜åŒ–**:
   - ä½¿ç”¨Variableè‡ªåŠ¨å¾®åˆ†,æ— æ‰‹åŠ¨æ¢¯åº¦è®¡ç®—
   - è®¡ç®—å›¾è‡ªåŠ¨ä¼˜åŒ–å†…å­˜ä½¿ç”¨

### 5.3 è¿è¡Œæ—¶æ€§èƒ½

**å›¾åƒç¼–ç åŸºå‡†** (Tinyé…ç½®, 2å¼ 256Ã—256å›¾åƒ):
- ç¼–ç è€—æ—¶: ~6ç§’ (æœªä¼˜åŒ–é¦–æ¬¡è¿è¡Œ)
- ç‰¹å¾æ•°é‡: 2Ã—256Ã—512 = 262,144ç»´

**ä¼˜åŒ–æ–¹å‘**:
- JITç¼–è¯‘é¢„çƒ­å¯æå‡2-3å€
- æ‰¹å¤„ç†ä¼˜åŒ–å¯è¿›ä¸€æ­¥æå‡ååé‡
- åç»­å¯é›†æˆGPUåŠ é€Ÿ

---

## å…­ã€æ‰©å±•æ€§è®¾è®¡

### 6.1 ä»»åŠ¡ç±»å‹æ‰©å±•

```java
public enum TaskType {
    TEXT_TO_IMAGE("æ–‡æœ¬ç”Ÿæˆå›¾åƒ"),
    IMAGE_TO_TEXT("å›¾åƒç”Ÿæˆæè¿°"),
    IMAGE_EDITING("å›¾åƒç¼–è¾‘"),
    MULTIMODAL_UNDERSTANDING("å¤šæ¨¡æ€ç†è§£"),
    ZERO_SHOT_CLASSIFICATION("é›¶æ ·æœ¬åˆ†ç±»");
}
```

æ”¯æŒå¤šç§å¤šæ¨¡æ€ä»»åŠ¡åœºæ™¯ã€‚

### 6.2 æ¨¡å‹è§„æ¨¡æ‰©å±•

**å½“å‰**: Tiny (60M) / Small (167M) / Base (386M)

**æ‰©å±•æ–¹å‘**:
- Large (1B+): å¢åŠ å±‚æ•°å’Œéšè—ç»´åº¦
- Mixture-of-Experts: å¼•å…¥MoEæ¶æ„
- å¤šåˆ†è¾¨ç‡æ”¯æŒ: æ”¯æŒæ›´å¤§å›¾åƒå°ºå¯¸

### 6.3 æ¨¡æ€æ‰©å±•

**å½“å‰**: æ–‡æœ¬ + å›¾åƒ

**æœªæ¥æ‰©å±•**:
- éŸ³é¢‘æ¨¡æ€: æ·»åŠ AudioEncoder
- è§†é¢‘æ¨¡æ€: æ—¶åºå›¾åƒå¤„ç†
- ä¸‰æ¨¡æ€èåˆ: Text-Image-Audio

---

## ä¸ƒã€å®æ–½æ€»ç»“

### 7.1 å¼€å‘æˆæœ

| é˜¶æ®µ | æ ¸å¿ƒç»„ä»¶ | æ–‡ä»¶æ•° | ä»£ç è¡Œæ•° | çŠ¶æ€ |
|------|---------|--------|---------|------|
| é˜¶æ®µä¸€ | é…ç½®+æ¶æ„ | 4 | 962 | âœ… å®Œæˆ |
| é˜¶æ®µäºŒ | å›¾åƒç¼–ç  | 3 | 567 | âœ… å®Œæˆ |
| é˜¶æ®µä¸‰ | è·¨æ¨¡æ€èåˆ | 2 | 477 | âœ… å®Œæˆ |
| é˜¶æ®µå›› | è®­ç»ƒæ¡†æ¶ | 4 | 1429 | âœ… å®Œæˆ |
| **æ€»è®¡** | **å…¨éƒ¨** | **18** | **4,100** | âœ… **å®Œæˆ** |

### 7.2 æŠ€æœ¯åˆ›æ–°ç‚¹

1. **100% V2 APIå®ç°**: æ— V1ä¾èµ–,æ¶æ„çº¯å‡€
2. **Conv2D PatchåµŒå…¥**: é«˜æ•ˆçš„å›¾åƒåˆ‡ç‰‡å®ç°
3. **å¯å­¦ä¹ 2Dä½ç½®ç¼–ç **: é€‚åº”å›¾åƒç©ºé—´ç»“æ„
4. **åŒå‘è·¨æ¨¡æ€èåˆ**: Textâ†”ImageåŒå‘æ³¨æ„åŠ›
5. **é…ç½®é©±åŠ¨è®¾è®¡**: çµæ´»çš„æ¨¡å‹è§„æ¨¡é…ç½®
6. **å®Œæ•´è®­ç»ƒæ¡†æ¶**: æ”¯æŒé¢„è®­ç»ƒã€å¾®è°ƒã€æ—©åœç­‰ç‰¹æ€§

### 7.3 è´¨é‡ä¿éšœ

- âœ… ç¼–è¯‘é€šè¿‡(Maven clean compile)
- âœ… åŠŸèƒ½éªŒè¯(Demoè¿è¡ŒæˆåŠŸ)
- âœ… å›¾åƒç¼–ç æµ‹è¯•(2Ã—256Ã—256å›¾åƒæˆåŠŸç¼–ç )
- âœ… è®­ç»ƒæ¡†æ¶æµ‹è¯•(é¢„è®­ç»ƒ+å¾®è°ƒæµç¨‹éªŒè¯)
- âœ… ä»£ç è§„èŒƒ(éµå¾ªTinyAIç¼–ç æ ‡å‡†)
- âœ… æ–‡æ¡£å®Œæ•´(æŠ€æœ¯æ¶æ„+APIå‚è€ƒ)

### 7.4 åç»­è®¡åˆ’

1. **å›¾åƒè§£ç å™¨**: å®ç°ä»ç‰¹å¾åˆ°åƒç´ çš„ç”Ÿæˆ
2. **æ¨ç†ä¼˜åŒ–**: KV-Cacheã€é‡åŒ–ç­‰åŠ é€ŸæŠ€æœ¯
3. **åº”ç”¨ç¤ºä¾‹**: æ–‡æœ¬ç”Ÿæˆå›¾åƒã€å›¾åƒç¼–è¾‘ç­‰Demo

---

## é™„å½•

### A. å‚è€ƒèµ„æ–™

- Gemini 2.5 FlashæŠ€æœ¯æŠ¥å‘Š
- Vision Transformer (ViT) è®ºæ–‡: "An Image is Worth 16x16 Words"
- TinyAIæ¡†æ¶V2 APIæ–‡æ¡£

### B. ç›¸å…³æ–‡ä»¶

**æ ¸å¿ƒå®ç°**:
- [BananaConfig.java](../src/main/java/io/leavesfly/tinyai/banana/config/BananaConfig.java)
- [TextEncoder.java](../src/main/java/io/leavesfly/tinyai/banana/encoder/TextEncoder.java)
- [ImageEncoder.java](../src/main/java/io/leavesfly/tinyai/banana/encoder/ImageEncoder.java)
- [CrossModalAttention.java](../src/main/java/io/leavesfly/tinyai/banana/fusion/CrossModalAttention.java)
- [MultiModalFusion.java](../src/main/java/io/leavesfly/tinyai/banana/fusion/MultiModalFusion.java)
- [BananaBlock.java](../src/main/java/io/leavesfly/tinyai/banana/block/BananaBlock.java)
- [BananaModel.java](../src/main/java/io/leavesfly/tinyai/banana/model/BananaModel.java)

**æ¼”ç¤ºç¨‹åº**:
- [BananaDemo.java](../src/main/java/io/leavesfly/tinyai/banana/demo/BananaDemo.java)

---

**æ–‡æ¡£å®Œæˆ**: æœ¬æ–‡æ¡£è¯¦ç»†é˜è¿°äº†tinyai-model-bananaæ¨¡å—çš„æŠ€æœ¯æ¶æ„ã€æ ¸å¿ƒç»„ä»¶ã€å…³é”®å®ç°å’Œæ‰©å±•è®¾è®¡,ä¸ºåç»­å¼€å‘å’Œä½¿ç”¨æä¾›å…¨é¢æŒ‡å¯¼ã€‚

**æœ€åæ›´æ–°**: 2025-12-21  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
